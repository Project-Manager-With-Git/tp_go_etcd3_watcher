package watcher

import (
	"errors"

	log "github.com/Golang-Tools/loggerhelper"
	"go.etcd.io/etcd/api/v3/mvccpb"
	clientv3 "go.etcd.io/etcd/client/v3"
)

func Handdler(event *clientv3.Event) error {
	switch event.Type {
	case mvccpb.PUT:
		{
			log.Info("get put event", log.Dict{"key": string(event.Kv.Key), "value": string(event.Kv.Value)})
			return nil
		}
	case mvccpb.DELETE:
		{
			log.Info("get delete event", log.Dict{"key": string(event.Kv.Key)})
			return nil
		}
	default:
		{
			log.Error("get unknown event", log.Dict{"event_type": event.Type})
			return errors.New("get unknown event")
		}
	}
}
